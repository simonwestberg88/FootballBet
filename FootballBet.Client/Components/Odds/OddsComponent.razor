@using FootballBet.Shared.Models.Odds
@using FootballBet.Client.Services
@inject IOddsService OddsService;

<MudThemeProvider @bind-IsDarkMode="@_isDarkMode" Theme="_theme"/>
<MudText Align="Align.Center" Style="padding-bottom:15px;padding-top: 10px">HomeWin</MudText>
@foreach (var odd in _homeOdds)
{
    <MudPaper Style="display: flex; flex-direction: row; margin-bottom: 15px" Elevation="0">
        <MudPaper Style="width: 50%;">
            <MudText Align="Align.Center">@odd.HomeTeamGoals - @odd.AwayTeamGoals</MudText>
        </MudPaper>
        <MudPaper Style="@($"background:{_theme.PaletteDark.Secondary}; width: 50%")">
            <MudText Align="Align.Center">@odd.Odds</MudText>
        </MudPaper>
    </MudPaper>
}
<MudText Align="Align.Center" Style="padding-bottom:15px;padding-top: 10px">Draw</MudText>
@foreach (var odd in _drawOdds)
{
    <MudPaper Style="display: flex; flex-direction: row; margin-bottom: 15px" Elevation="0">
        <MudPaper Style="width: 50%;">
            <MudText Align="Align.Center">@odd.HomeTeamGoals - @odd.AwayTeamGoals</MudText>
        </MudPaper>
        <MudPaper Style="@($"background:{_theme.PaletteDark.Secondary}; width: 50%")">
            <MudText Align="Align.Center">@odd.Odds</MudText>
        </MudPaper>
    </MudPaper>
}
<MudText Align="Align.Center" Style="padding-bottom:15px;padding-top: 10px">Away</MudText>
@foreach (var odd in _awayOdds)
{
    <MudPaper Style="display: flex; flex-direction: row; margin-bottom: 15px" Elevation="0">
        <MudPaper Style="width: 50%;">
            <MudText Align="Align.Center">@odd.HomeTeamGoals - @odd.AwayTeamGoals</MudText>
        </MudPaper>
        <MudPaper Style="@($"background:{_theme.PaletteDark.Secondary}; width: 50%")">
            <MudText Align="Align.Center">@odd.Odds</MudText>
        </MudPaper>
    </MudPaper>
}

@code {

    [Parameter]
    public int MatchId { get; set; }

    [Parameter]
    public List<OddsDto>? Odds { get; set; }

    private bool _isDarkMode = true;
    private MudTheme _theme = new();

    private List<OddsDto> _odds = new();
    private static List<OddsDto>? _homeOdds;
    private static List<OddsDto>? _awayOdds;
    private static List<OddsDto>? _drawOdds;


    protected override async Task OnInitializedAsync()
    {
        _odds = (await OddsService.GetOdds(MatchId) ?? Array.Empty<OddsDto>()).ToList();
        _homeOdds = _odds.Where(o => o.MatchWinner == MatchWinnerEnumDto.Home).ToList();
        _awayOdds = _odds.Where(o => o.MatchWinner == MatchWinnerEnumDto.Away).ToList();
        _drawOdds = _odds.Where(o => o.MatchWinner == MatchWinnerEnumDto.Draw).ToList();
        await base.OnInitializedAsync();
    }

}