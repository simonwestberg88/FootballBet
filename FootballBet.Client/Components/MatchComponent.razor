@using FootballBet.Shared.Models.Match
@using FootballBet.Shared.Models.Odds
@using FootballBet.Client.Services
@inject IOddsService OddsService;

<MudPaper Elevation="2" Style="margin-top: 10px">
    <MudExpansionPanel @bind-IsExpanded="_isOpen" HideIcon="true">
        <TitleContent>
            <MudGrid>
                <MudItem xs="3" Style="display: flex; flex-direction: column; justify-content: center; align-items: center">
                    <MudText>@MatchData.HomeTeamName</MudText>
                    <MudImage Src="@MatchData.HomeTeamLogo" Width="Width" Height="Height"></MudImage>
                </MudItem>
                <MudItem xs="6" Style="display: flex; justify-content: center; align-items: center">
                    <MudItem style="display: block">
                        <MudText Style="text-align: center">@MatchData.Date.ToString("H:mm")</MudText>
                        <MudText Style="text-align: center">@MatchData.HomeCurrentGoals - @MatchData.AwayCurrentGoals</MudText>

                    </MudItem>
                </MudItem>
                <MudItem xs="3" Style="display: flex; flex-direction: column; justify-content: center; align-items: center">
                    <MudText>@MatchData.AwayTeamName</MudText>
                    <MudImage Src="@MatchData.AwayTeamLogo" Width="Width" Height="Height"></MudImage>
                </MudItem>
            </MudGrid>
        </TitleContent>
        <ChildContent>
            <MudText Style="padding-top: 10px">@(MatchData.MatchStatus)</MudText>
            <OddsComponent MatchId="MatchData.MatchId" Odds="@_odds.ToList()"></OddsComponent>
            </ChildContent>
        </MudExpansionPanel>
    </MudPaper>

    @code {

    [Parameter]
    public MatchDto MatchData { get; set; }
    private IEnumerable<OddsDto>? _odds;

    bool _isOpen;

    private static int Width => 50;
    private int Height => 50;
    protected override async Task OnInitializedAsync()
    {
        _odds = await OddsService.GetOdds(MatchData.MatchId);
        await base.OnInitializedAsync();
    }

}